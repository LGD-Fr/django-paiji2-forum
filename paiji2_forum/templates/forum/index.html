{% extends 'forum/all.html' %}

{% comment %}

Copyright (C) 2015 Louis-Guillaume DUBOIS

This file is part of paiji2-forum

paiji2-forum is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

paiji2-forum is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.

{% endcomment %}
{% load i18n %}
{% load static %}
{% load mptt_tags %}

{% block class-topics %}active{% endblock %}
{% block class-unread %}{% endblock %}
{% block class-recent %}{% endblock %}
{% block class-new %}{% endblock %}

{% block forum-top-nav %}{% endblock %}
{% block forum-bottom-nav %}{% endblock %}

{% block forum-content %}

<ul class="topic">
    {% recursetree object_list %}
        <li>
            <div {% if node == message %}id="forum-message"{% elif node == question %}id="forum-question"{% endif %}>
                <a class="forum-message-title" href="{% url 'forum:message' node.pk %}#forum-message">
                    <img class="forum-icon" src="{% static node.icon.url %}" alt="{{ node.icon.name }}"/>
                    {{ node.title }}
                </a>
                <small> 
                    <span class="label label-default label-sm" title="{% blocktrans count nb=node.readers.count %}one reading{% plural %}{{ nb }} readings{% endblocktrans %}">{{ node.readers.count }}</span>
                    {% if not node.is_read %}
                    <span class="label label-sm label-success">{% trans 'unread' context 'sing' %}</span>
                    {% endif %}
                    <a class="forum-author"
                    {% if expand %}
                    href="{% url 'forum:topic' node.pk %}#forum-message"
                    {% else %}
                    href="{% url 'forum:message' node.pk %}#forum-message"
                    {% endif %}
                    title="{{ node.author.first_name }} {{ node.author.last_name }} ({{ node.author }})">
                        {% if node.author.first_name %}
                        {{ node.author.first_name }}
                        {% else %}
                        {{ node.author }}
                        {% endif %}
                    </a>
                    <span class="text-muted">{% blocktrans with TimeSince=node.pub_date|timesince %}{{ TimeSince }} ago{% endblocktrans %}</span>
                </small>
            </div>
            {% if node.is_leaf_node %}
            <ul class="answers">
                {{ children }}
            </ul>
            {% endif %}
        </li>
    {% endrecursetree %}
</ul>

{% endblock %}

{% block text %}{% endblock %}
{% block topic-name %}{% endblock %}
