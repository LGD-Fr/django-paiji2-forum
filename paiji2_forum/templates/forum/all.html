{% extends "forum/base.html" %}
{% comment %}

Copyright (C) 2015 Louis-Guillaume DUBOIS

This file is part of paiji2-forum

paiji2-forum is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

paiji2-forum is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.

{% endcomment %}
{% load static %}
{% load i18n %}
{% load mptt_tags %}
{% load profile %}

{% block forum-top-nav %}

<ul class="pager">
    <li class="previous {% if not message.prev_topic %}disabled{% endif %}">
        <a {% if message.prev_topic %}href="{% url 'forum:message' message.prev_topic.pk %}#forum-message"{% endif %}>
        <span class="glyphicon glyphicon-arrow-left"></span>
        {% trans 'topic' %}
        </a>
    <li>
        <a id="forum-top" href="#forum-bottom">
            <span class="glyphicon glyphicon-arrow-down"></span>
            {% trans 'bottom' %}
        </a>
    </li>
    <li class="next {% if not message.next_topic %}disabled{% endif %}">
        <a {% if message.next_topic %}href="{% url 'forum:message' message.next_topic.pk %}#forum-message"{% endif %}>
        {% trans 'topic' %}
        <span class="glyphicon glyphicon-arrow-right"></span>
        </a>
    </li>
</ul>

{% endblock %}



{% block forum-content %}

{% for msg  in object_list %}

    {% block message-title %}

    <div {% if msg == message %}id="forum-message"{% elif msg == question %}id="forum-question"{% endif %} {% block entry-class %}class ="{%if msg.is_topic %}topic-entry {% endif %}forum-entry"{% endblock %} {% block padding %}style="margin-left: {{ msg.padding }}px;"{% endblock %}>
        <a class="forum-message-title" href="{% url 'forum:message' msg.pk %}#forum-message">
            <img class="forum-icon" src="{% static msg.icon.url %}" alt="{{ msg.icon.name }}"/>
            {{ msg.title }}
        </a>
        <small> 
            <span class="label label-default label-sm" title="{% blocktrans count nb=msg.readers.count %}one reading{% plural %}{{ nb }} readings{% endblocktrans %}">{{ msg.readers.count }}</span>
            {% if request.user not in msg.readers.all %}
            <span class="label label-sm label-success">{% trans 'unread' context 'sing' %}</span>
            {% endif %}
        </small>
        {% profile_link msg.author %}
        <small>
            <span class="text-muted">{% blocktrans with TimeSince=msg.pub_date|timesince %}{{ TimeSince }} ago{% endblocktrans %}</span>
        </small>

        {% block topic-name %}
        <span class="text-muted"> [{% trans 'topic' %} : </span><span class="forum-message-title">{{ msg.topic }}</a><span class="text-muted">]</span>
        {% endblock %}

    {% endblock %}

</div>

{% empty %}
    
    <span class="label label-default">{% trans 'no message' %}</span>

{% endfor %}

{% endblock %}



{% block forum-bottom-nav %}

<ul class="pager">
    <li class="previous {% if not message.prev_topic %}disabled{% endif %}">
        <a {% if message.prev_topic %}href="{% url 'forum:message' message.prev_topic.pk %}#forum-message"{% endif %}>
        <span class="glyphicon glyphicon-arrow-left"></span>
        {% trans 'topic' %}
        </a>
    <li>
        <a id="forum-bottom" href="#forum-top">
            <span class="glyphicon glyphicon-arrow-up"></span>
            {% trans 'top' %}
        </a>
    </li>
    <li class="next {% if not message.next_topic %}disabled{% endif %}">
        <a {% if message.next_topic %}href="{% url 'forum:message' message.next_topic.pk %}#forum-message"{% endif %}>
        {% trans 'topic' %}
        <span class="glyphicon glyphicon-arrow-right"></span>
        </a>
    </li>
</ul>

{% endblock %}
